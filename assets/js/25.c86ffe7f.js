(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{458:function(t,s,e){t.exports=e.p+"assets/img/optimize.b8e2fb94.jpg"},548:function(t,s,e){"use strict";e.r(s);var n=e(9),a=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("主要介绍下如何在 "),s("code",[t._v("pure-admin")]),t._v(" 平台进行正确有效的 "),s("code",[t._v("vite")]),t._v(" 预构建配置")]),t._v(" "),s("h2",{attrs:{id:"include"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#include"}},[t._v("#")]),t._v(" "),s("code",[t._v("include")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/pure-admin/pure-admin-thin/blob/main/build/optimize.ts#L7",target:"_blank",rel:"noopener noreferrer"}},[t._v("optimizeDeps.include"),s("OutboundLink")],1),t._v(" 配置为需要预构建的模块。"),s("code",[t._v("vite")]),t._v(" 启动时会将 "),s("code",[t._v("optimizeDeps.include")]),t._v(" 里的模块，编译成 "),s("code",[t._v("esm")]),t._v(" 格式并缓存到 "),s("code",[t._v("node_modules/.vite")]),t._v(" 文件夹，页面加载到对应模块时如果浏览器有缓存就读取浏览器缓存，如果没有会读取本地缓存并按需加载")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"img","data-src":e(458),loading:"lazy"}})]),t._v(" "),s("p",[t._v("下面是精简版 "),s("code",[t._v("optimizeDeps.include")]),t._v(" 配置，将 "),s("a",{attrs:{href:"https://github.com/pure-admin/pure-admin-thin/blob/main/package.json#L50-L75",target:"_blank",rel:"noopener noreferrer"}},[t._v("dependencies"),s("OutboundLink")],1),t._v(" 大部分未全局安装的模块都配置进来，当然如果模块里面的东西很少，也就是里面方法不多，可以不用配置进来直接让浏览器加载即可（您自己安装的模块也是参考该配置）")]),t._v(" "),s("details",{staticClass:"custom-block details"},[s("summary",[t._v("点击查看")]),t._v(" "),s("div",{staticClass:"language-ts line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" include "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"qs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mitt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dayjs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"axios"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pinia"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-types"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js-cookie"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-tippy"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pinyin-pro"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sortablejs"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@vueuse/core"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@pureadmin/utils"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"responsive-storage"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("ol",[s("li",[t._v("尤其当您禁用浏览器缓存时（这种情况只应该发生在调试阶段）必须将对应模块加入到 "),s("code",[t._v("include")]),t._v(" 里，否则会遇到开发环境切换页面卡顿的问题（"),s("code",[t._v("vite")]),t._v(" 会认为它是一个新的依赖包会重新加载并强制刷新页面），因为它既无法使用浏览器缓存，又没有在本地 "),s("code",[t._v("node_modules/.vite")]),t._v(" 里缓存")]),t._v(" "),s("li",[t._v("如果您使用的第三方库是全局引入，也就是引入到 "),s("code",[t._v("src/main.ts")]),t._v(" 文件里，就不需要再添加到 "),s("code",[t._v("include")]),t._v(" 里了，因为 "),s("code",[t._v("vite")]),t._v(" 会自动将它们缓存到 "),s("code",[t._v("node_modules/.vite")])])])]),t._v(" "),s("h2",{attrs:{id:"exclude"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#exclude"}},[t._v("#")]),t._v(" "),s("code",[t._v("exclude")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/pure-admin/pure-admin-thin/blob/main/build/optimize.ts#L27",target:"_blank",rel:"noopener noreferrer"}},[t._v("optimizeDeps.exclude"),s("OutboundLink")],1),t._v(" 配置为排除预构建的模块。平台推荐的使用方式是哪里需要哪里引入而且都是单个的引入，不需要预构建，直接让浏览器加载就好")]),t._v(" "),s("p",[t._v("下面是精简版 "),s("code",[t._v("optimizeDeps.exclude")]),t._v(" 配置")]),t._v(" "),s("details",{staticClass:"custom-block details"},[s("summary",[t._v("点击查看")]),t._v(" "),s("div",{staticClass:"language-ts line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exclude "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@iconify/json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("推荐阅读")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://cn.vitejs.dev/guide/dep-pre-bundling.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("依赖预构建"),s("OutboundLink")],1),t._v(" "),s("Badge",{attrs:{text:"vite文档"}})],1),t._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.cn/post/7064853960636989454",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入理解 Vite 核心原理"),s("OutboundLink")],1)])])])])}),[],!1,null,null,null);s.default=a.exports}}]);