---
title: è·¯ç”±å’Œèœå•
date: 2022-11-07
permalink: /pages/routerMenu/
---

## ä¸€ï¼šé…ç½®é¡¹

```ts
const routes = {
  /** è·¯ç”±åœ°å€ `å¿…å¡«` */
  path: string;
  /** è·¯ç”±åå­—ï¼ˆä¿æŒå”¯ä¸€ï¼‰`å¯é€‰` */
  name?: string;
  /** `Layout`ç»„ä»¶ `å¯é€‰` */
  component?: RouteComponent;
  /** è·¯ç”±é‡å®šå‘ `å¯é€‰` */
  redirect?: string;
  meta?: {
    /** èœå•åç§°ï¼ˆå…¼å®¹å›½é™…åŒ–ã€éå›½é™…åŒ–ï¼Œå¦‚ä½•ç”¨å›½é™…åŒ–çš„å†™æ³•å°±å¿…é¡»åœ¨æ ¹ç›®å½•çš„`locales`æ–‡ä»¶å¤¹ä¸‹å¯¹åº”æ·»åŠ ï¼‰`å¿…å¡«` */
    title: string;
    /** èœå•å›¾æ ‡ `å¯é€‰` */
    icon?: string;
    /** æ˜¯å¦åœ¨èœå•ä¸­æ˜¾ç¤ºï¼ˆé»˜è®¤`true`ï¼‰`å¯é€‰` */
    showLink?: boolean;
    /** èœå•å‡åºæ’åºï¼Œå€¼è¶Šé«˜æ’çš„è¶Šåï¼ˆåªé’ˆå¯¹é¡¶çº§è·¯ç”±ï¼‰`å¯é€‰` */
    rank?: number;
  };
  // å­è·¯ç”±é…ç½®é¡¹
  children: [
    {
      /** å­è·¯ç”±åœ°å€ `å¿…å¡«` */
      path: string;
      /** è·¯ç”±åå­—ï¼ˆå¯¹åº”ä¸è¦é‡å¤ï¼Œå’Œå½“å‰ç»„ä»¶çš„`name`ä¿æŒä¸€è‡´ï¼‰`å¿…å¡«` */
      name?: string;
      /** è·¯ç”±é‡å®šå‘ `å¯é€‰` */
      redirect?: string;
      /** æŒ‰éœ€åŠ è½½ç»„ä»¶ `å¯é€‰` */
      component?: RouteComponent;
      meta?: {
        /** èœå•åç§°ï¼ˆå…¼å®¹å›½é™…åŒ–ã€éå›½é™…åŒ–ï¼Œå¦‚ä½•ç”¨å›½é™…åŒ–çš„å†™æ³•å°±å¿…é¡»åœ¨æ ¹ç›®å½•çš„`locales`æ–‡ä»¶å¤¹ä¸‹å¯¹åº”æ·»åŠ ï¼‰ `å¿…å¡«` */
        title: string;
        /** èœå•å›¾æ ‡ `å¯é€‰` */
        icon?: string;
        /** èœå•åç§°å³ä¾§çš„é¢å¤–å›¾æ ‡ï¼Œæ”¯æŒ`fontawesome`ã€`iconfont`ã€`element-plus-icon` `å¯é€‰` */
        extraIcon?: {
          svg?: boolean;
          name?: string;
        };
        /** æ˜¯å¦åœ¨èœå•ä¸­æ˜¾ç¤ºï¼ˆé»˜è®¤`true`ï¼‰`å¯é€‰` */
        showLink?: boolean;
        /** æ˜¯å¦æ˜¾ç¤ºçˆ¶çº§èœå• `å¯é€‰` */
        showParent?: boolean;
        /** è·¯ç”±æƒé™è®¾ç½® `å¯é€‰` */
        authority?: Array<string>;
        /** è·¯ç”±ç»„ä»¶ç¼“å­˜ï¼ˆå¼€å¯ `true`ã€å…³é—­ `false`ï¼‰`å¯é€‰` */
        keepAlive?: boolean;
        /** å†…åµŒçš„`iframe`é“¾æ¥ `å¯é€‰` */
        frameSrc?: string;
        /** `iframe`é¡µæ˜¯å¦å¼€å¯é¦–æ¬¡åŠ è½½åŠ¨ç”»ï¼ˆé»˜è®¤`true`ï¼‰`å¯é€‰` */
        frameLoading?: boolean;
        /** é¡µé¢åŠ è½½åŠ¨ç”»ï¼ˆæœ‰ä¸¤ç§å½¢å¼ï¼Œä¸€ç§ç›´æ¥é‡‡ç”¨vueå†…ç½®çš„`transitions`åŠ¨ç”»ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨`animate.css`å†™è¿›ã€ç¦»åœºåŠ¨ç”»ï¼‰`å¯é€‰` */
        transition?: {
          /**
           * @description å½“å‰è·¯ç”±åŠ¨ç”»æ•ˆæœ
           * @see {@link https://next.router.vuejs.org/guide/advanced/transitions.html#transitions}
           */
          name?: string;
          /** è¿›åœºåŠ¨ç”» */
          enterTransition?: string;
          /** ç¦»åœºåŠ¨ç”» */
          leaveTransition?: string;
        };
        // æ˜¯å¦ä¸æ·»åŠ ä¿¡æ¯åˆ°æ ‡ç­¾é¡µï¼Œï¼ˆé»˜è®¤`false`ï¼‰
        hiddenTag?: boolean;
        /** åŠ¨æ€è·¯ç”±å¯æ‰“å¼€çš„æœ€å¤§æ•°é‡ `å¯é€‰` */
        dynamicLevel?: number;
      };
    },
  ],
};
```

## äºŒï¼šåå°è¿”å›è·¯ç”±ç”Ÿæˆèœå•çš„å„ç§æ ¼å¼é…ç½®å‚è€ƒï¼ˆä¸Šé¢ä»£ç ï¼Œä¸‹é¢å¯¹åº”æ•ˆæœæˆªå›¾ï¼‰

ç®€è¿°ï¼šä¸€èˆ¬ä¸€çº§èœå•ä»£è¡¨æ— ä»»ä½•å­èœå•çš„èœå•ï¼ŒäºŒçº§èœå•ä»£è¡¨ä¸€çº§èœå•ä¸‹é¢æœ‰å­èœå•ï¼Œä¸‰çº§èœå•ä»£è¡¨äºŒçº§èœå•ä¸‹é¢æœ‰å­èœå•ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä¸‹é¢ä¾‹å­çš„å›½é™…åŒ–ï¼Œæˆ‘åªåœ¨ä¸€çº§èœå•é‚£ä¸¾ä¾‹

### ä¸€çº§èœå•æœ€ç®€å•çš„æ ¼å¼ï¼ˆå›½é™…åŒ–ï¼‰

```ts
const aboutRouter = {
  meta: {
    // èœå•æ’åºæ˜¾ç¤ºç­‰çº§
    rank: 12,
  },
  children: [
    {
      // è·¯ç”±è·¯å¾„
      path: "/about",
      // é¡µé¢nameï¼Œä½œä¸ºä¸€ç§è§„èŒƒå¿…ä¼ 
      name: "About",
      meta: {
        // èœå•æ ‡é¢˜
        title: "menus.hsAbout",
      },
    },
  ],
};
```

![router1](~@alias/img/router/router1.png)

### ä¸€çº§èœå•æœ€ç®€å•çš„æ ¼å¼ï¼ˆéå›½é™…åŒ–ï¼‰

```ts
const aboutRouter = {
  meta: {
    // èœå•æ’åºæ˜¾ç¤ºç­‰çº§
    rank: 12,
  },
  children: [
    {
      // è·¯ç”±è·¯å¾„
      path: "/about",
      // é¡µé¢nameï¼Œä½œä¸ºä¸€ç§è§„èŒƒå¿…ä¼ 
      name: "About",
      meta: {
        // èœå•æ ‡é¢˜
        title: "å…³äº",
      },
    },
  ],
};
```

![router2](~@alias/img/router/router2.png)

### äºŒçº§èœå•æœ€ç®€å•çš„æ ¼å¼ï¼ˆæœ‰ä¸¤ç§æ¨¡å¼ï¼‰

â‘  ç¬¬ä¸€ç§ï¼ˆè¿™ç§æ¨¡å¼é’ˆå¯¹çˆ¶çº§èœå•ä¸‹åªæœ‰ä¸€ä¸ªå­èœå•çš„æƒ…å†µï¼Œåœ¨å­èœå•çš„ meta å±æ€§ä¸­åŠ ä¸Š showParent: true å³å¯ï¼‰

```ts
const aboutRouter = {
  // è¿™é‡Œçš„pathåœ°å€å¯ä»¥éšä¾¿å†™ï¼ˆå‰æä»¥/å¼€å¤´ï¼Œè€Œä¸”ä¸èƒ½å’Œå­è·¯ç”±çš„pathè·¯å¾„é‡å¤ï¼‰ï¼Œä½†æ˜¯ä¸èƒ½ä¸å†™ï¼Œå› ä¸ºä¸ä½œä¸ºè·³è½¬ï¼Œè·³è½¬èµ°çš„æ˜¯å­è·¯ç”±çš„pathï¼Œä¹Ÿå°±æ˜¯/about
  path: "/",
  meta: {
    // èœå•æ ‡é¢˜
    title: "å…³äº",
    // èœå•æ’åºæ˜¾ç¤ºç­‰çº§
    rank: 12,
  },
  children: [
    {
      // è·¯ç”±è·¯å¾„
      path: "/about",
      // é¡µé¢nameï¼Œä½œä¸ºä¸€ç§è§„èŒƒå¿…ä¼ 
      name: "About",
      meta: {
        // èœå•æ ‡é¢˜
        title: "å…³äºï¼ˆå­èœå•ï¼‰",
        showParent: true,
      },
    },
  ],
};
```

![router3](~@alias/img/router/router3.png)

â‘¡ ç¬¬äºŒç§ï¼ˆè¿™ç§æ¨¡å¼é’ˆå¯¹çˆ¶çº§èœå•ä¸‹æœ‰å¤§äºæˆ–ç­‰äºä¸¤ä¸ªå­èœå•çš„æƒ…å†µï¼‰

```ts
const systemRouter = {
  path: "/system",
  meta: {
    title: "ç³»ç»Ÿç®¡ç†",
    rank: 6,
  },
  children: [
    {
      path: "/system/user/index",
      name: "User",
      meta: {
        title: "åŸºç¡€ä¿¡æ¯",
      },
    },
    {
      path: "/system/dict/index",
      name: "Dict",
      meta: {
        title: "å­—å…¸ç®¡ç†",
      },
    },
  ],
};
```

![router6](~@alias/img/router/router6.png)

### ä¸‰çº§èœå•æœ€ç®€å•çš„æ ¼å¼

```ts
const nestedRouter = {
  path: "/nested",
  meta: {
    title: "å¤šçº§èœå•",
    rank: 8,
  },
  children: [
    {
      path: "/nested/menu1",
      meta: {
        title: "èœå•1",
      },
      children: [
        {
          path: "/nested/menu1/menu1-1/index",
          name: "Menu1-1",
          meta: {
            title: "èœå•1-1",
          },
        },
        {
          path: "/nested/menu1/menu1-3/index",
          name: "Menu1-3",
          meta: {
            title: "èœå•1-3",
          },
        },
      ],
    },
  ],
};
```

![router4](~@alias/img/router/router4.png)

### å››çº§èœå•æœ€ç®€å•çš„æ ¼å¼

```ts
const nestedRouter = {
  path: "/nested",
  meta: {
    title: "å¤šçº§èœå•",
    rank: 8,
  },
  children: [
    {
      path: "/nested/menu1",
      meta: {
        title: "èœå•1",
      },
      children: [
        {
          path: "/nested/menu1/menu1-1/index",
          name: "Menu1-1",
          meta: {
            title: "èœå•1-1",
          },
        },
        {
          path: "/nested/menu1/menu1-2",
          meta: {
            title: "èœå•1-2",
          },
          children: [
            {
              path: "/nested/menu1/menu1-2/menu1-2-1",
              name: "Menu1-2-1",
              meta: {
                title: "èœå•1-2-1",
                showParent: true,
              },
            },
          ],
        },
      ],
    },
  ],
};
```

![router5](~@alias/img/router/router5.png)

### å†…åµŒ`iframe`å’Œ`å¤–é“¾`

```ts
const frameRouter = {
  path: "/iframe",
  meta: {
    title: "å¤–éƒ¨é¡µé¢",
    rank: 10,
  },
  children: [
    {
      // iframe
      path: "/iframe/pure",
      name: "FramePure",
      meta: {
        title: "å¹³å°æ–‡æ¡£(å†…åµŒ)",
        // æŠŠè¦å†…åµŒçš„iframeé“¾æ¥å†™åœ¨frameSrcå±æ€§ä¸Šå³å¯
        frameSrc: "https://yiming_chang.gitee.io/pure-admin-doc",
      },
    },
    {
      // å¤–é“¾
      path: "/external",
      // æŠŠè¦è·³è½¬åˆ°çš„å¤–éƒ¨é“¾æ¥å†™åœ¨nameå±æ€§ä¸Šå³å¯
      name: "https://yiming_chang.gitee.io/pure-admin-doc",
      meta: {
        title: "å¹³å°æ–‡æ¡£(å¤–é“¾)",
      },
    },
  ],
};
```

![router7](~@alias/img/router/router7.png)

## ä¸‰ï¼šåç«¯ä¼  component ç»„ä»¶ä¸¤ç§æ¨¡å¼

[router/utils.ts](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/router/utils.ts#L241) <Badge text="ä»£ç "/>

- å¯¹åç«¯ä¼ `component`ç»„ä»¶è·¯å¾„å’Œä¸ä¼ åšå…¼å®¹ï¼ˆå¦‚æœåç«¯ä¼ `component`ç»„ä»¶è·¯å¾„ï¼Œé‚£ä¹ˆ`path`å¯ä»¥éšä¾¿å†™ï¼Œå¦‚æœä¸ä¼ ï¼Œ`component`ç»„ä»¶è·¯å¾„ä¼šæ ¹ path ä¿æŒä¸€è‡´ï¼‰

- å¯¹äºåç«¯ä¼ `component`çš„[ä»£ç å‚è€ƒ](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/mock/asyncRoutes.ts#L39)

## å››ï¼šé‡ç½®è·¯ç”±ï¼ˆä¸»è¦ç”¨äºç”¨æˆ·è§’è‰²åˆ‡æ¢ï¼‰

[resetRouter](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/router/index.ts#L98) <Badge text="ä»£ç "/>

```sh
import { resetRouter } from "/@/router";
resetRouter()
```

## äº”ï¼šå¦‚ä½•æ·»åŠ æ— `layout`çš„é¡µé¢

- æ— `layout`é¡µé¢ä¹Ÿå°±ç›¸å½“äºä¸€ä¸ªå…¨å±ç©ºç™½é¡µé¢ï¼Œæ²¡æœ‰èœå•å¯¼èˆªä»¥åŠç›¸å…³æ¨¡å—ï¼Œç±»ä¼¼ä¸‹å›¾

![empty](~@alias/img/router/empty.gif)

- [å®ç°ä»£ç å‚è€ƒ](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/router/modules/remaining.ts#L33)ï¼Œå› ä¸ºè¿™ç§åœºæ™¯æå°‘å‘ç”Ÿï¼Œæ‰€ä»¥åªéœ€åœ¨å‰ç«¯é…ç½®å³å¯ï¼Œé…ç½®çš„ç›¸å¯¹è·¯å¾„`src/router/modules/remaining.ts`

## å…­ï¼šå¹³å°å°†åå°è¿”å›è·¯ç”±å’Œå‰ç«¯é™æ€è·¯ç”±ç›¸ç»“åˆï¼Œå¦‚æœåªæƒ³è¦å‰ç«¯é™æ€è·¯ç”±ï¼Œè€Œä¸æƒ³èµ°æ¥å£å»è¯·æ±‚åå°è¿”å›çš„è·¯ç”±ï¼Œéœ€è¦å¦‚ä½•åšå‘¢

å¹³å°å°†åå°è¿”å›è·¯ç”±å’Œå‰ç«¯é™æ€è·¯ç”±ç›¸ç»“åˆæ˜¯å› ä¸ºå¹³å°æƒ³è¦æä¾›è¿™ä¸¤ç§æ–¹å¼ç»™ä½¿ç”¨è€…ä½œä¸ºå­¦ä¹ å‚è€ƒ

- å¦‚ä½•åšï¼Ÿå…¶å®åªéœ€è¦ç®€å•çš„ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹å³å¯  
  â‘  æ¥åˆ° [views/login/index.vue](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/views/login/index.vue) ï¼ŒæŒ‰ç…§ä¸‹å›¾å³ä¾§ä»£ç è¿›è¡Œä¿®æ”¹

![static](~@alias/img/router/static.jpg)

- å³ä¾§ä»£ç 

```ts
import { usePermissionStoreHook } from "/@/store/modules/permission";

usePermissionStoreHook().changeSetting([]);
```

â‘¡ æ¥åˆ° [router/index.ts](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/router/index.ts#L144) ï¼ŒæŒ‰ç…§ä¸‹å›¾å³ä¾§ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œè¿™ä¸€æ­¥æ”¹å®Œèµ¶ç´§çœ‹çœ‹æ•ˆæœå§ ğŸ‰

![static](~@alias/img/router/static1.jpg)

- å³ä¾§ä»£ç 

```ts
// åˆ·æ–°
if (usePermissionStoreHook().wholeMenus.length === 0)
  usePermissionStoreHook().changeSetting([]);
if (!useMultiTagsStoreHook().getMultiTagsCache) {
  const { path } = to;
  const index = findIndex(remainingRouter, (v) => {
    return v.path == path;
  });
  const routes: any =
    index === -1 ? router.options.routes[0].children : router.options.routes;
  const route = findRouteByPath(path, routes);
  // queryã€paramsæ¨¡å¼è·¯ç”±ä¼ å‚æ•°çš„æ ‡ç­¾é¡µä¸åœ¨æ­¤å¤„å¤„ç†
  if (route && route.meta?.title) {
    useMultiTagsStoreHook().handleTags("push", {
      path: route.path,
      name: route.name,
      meta: route.meta,
    });
  }
}
next();
```

::: tip æ¸©é¦¨æç¤º â¤ï¸

è™½ç„¶`vue-router`å®˜æ–¹åªæ”¯æŒåˆ°äºŒçº§`keep-alive`ç¼“å­˜ï¼Œä½†å¹³å°å¯¹è·¯ç”±è¿›è¡Œäº†å¤„ç†ï¼Œåªè¦å¯¹å½“å‰è·¯ç”±è®¾ç½®äº†`keepAlive: true`ï¼Œå¹¶ä¸”å¯¹åº”çš„é¡µé¢`name`ä¸è·¯ç”±çš„ `name`ä¿æŒä¸€è‡´ï¼Œä¸ç®¡å±‚çº§å¤šæ·±éƒ½ä¼šæ”¯æŒ`keep-alive`ç¼“å­˜

:::
